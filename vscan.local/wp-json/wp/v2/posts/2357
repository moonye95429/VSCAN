{"id":2357,"date":"2017-11-15T21:37:38","date_gmt":"2017-11-15T13:37:38","guid":{"rendered":"http:\/\/vscan.local\/?p=2357"},"modified":"2017-12-24T16:33:53","modified_gmt":"2017-12-24T08:33:53","slug":"sql-injection","status":"publish","type":"post","link":"http:\/\/vscan.local\/blog\/sql-injection\/","title":{"rendered":"SQL Injection"},"content":{"rendered":"<p>SQL Injection \u87ec\u806f OWASP TOP 10 \u51a0\u8ecd\u5bf6\u5ea7\u5f9e2013\u5e74\u7248\u5230\u6700\u65b0\u76842017\u5e74\u7248\uff0c\u53ef\u898b\u5176\u9020\u6210\u7684\u50b7\u5bb3\u53ca\u666e\u904d\u6027\u4e4b\u9ad8\uff0c\u7562\u7adf\u958b\u767c\u4eba\u54e1\u5728\u5c07\u5916\u90e8\u53c3\u6578\u4e1f\u5165 SQL \u547d\u4ee4\u5217\u6642\uff0c\u70ba\u4e86\u65b9\u4fbf\u5c31\u76f4\u63a5\u5e36\u5165\uff0c\u7701\u7565\u4e86\u904e\u6ffe\u6216\u7528\u53c3\u6578\u5316\u7684\u65b9\u5f0f\uff0c\u76f8\u4fe1\u6709\u5beb\u904e\u4e32\u63a5 Database \u7684\u7db2\u7ad9\u958b\u767c\u4eba\u54e1\u90fd\u6703\u6709\u7684\u7d93\u9a57\u3002<\/p>\n<p>SQL Injection \u70ba\u900f\u904e\u5916\u90e8\u4f7f\u7528\u8005\u7684\u8f38\u5165\u6216\u53ef\u4f9b\u6539\u9020\u7684\u53c3\u6578\uff0c\u672a\u7d93\u9a57\u8b49\u5c31\u5e36\u5165 SQL \u76f8\u95dc\u6307\u4ee4\u88ab\u57f7\u884c\uff0c\u5c0e\u81f4\u8df3\u812b\u539f\u5148\u9810\u671f\u7684\u884c\u70ba\uff0c\u8b8a\u6210\u653b\u64ca\u8005\u60f3\u8981\u7684\u884c\u70ba\u3002\u653b\u64ca\u884c\u70ba\u53ef\u5229\u7528 SQL \u7684\u6307\u4ee4\u5982 SELECT\u3001UPDATE \u6216 DELETE \u7b49\u4f86\u9020\u6210\u8cc7\u6599\u5eab\u975e\u9810\u671f\u7684\u884c\u70ba\uff0c\u82e5\u57f7\u884c\u6b0a\u9650\u53c8\u6c92\u7279\u5225\u53bb\u505a\u5340\u5206\uff0c\u7b49\u65bc\u5c07\u6574\u500b\u8cc7\u6599\u5eab\u88ab\u5916\u90e8\u4efb\u610f\u5b58\u53d6\u8207\u52d5\u4f5c\uff0c\u751a\u81f3\u53ef\u7528\u4f86\u57f7\u884c\u6307\u4ee4\u78bc\uff0c\u5f8c\u679c\u5c07\u96e3\u4ee5\u5f4c\u88dc\uff01<\/p>\n<p>&nbsp;<\/p>\n<h4>SQL Injection \u653b\u64ca\u578b\u614b\u985e\u578b<\/h4>\n<ul>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/7.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-7\uff1a\u76f2\u76ee\u7684SQL\u6ce8\u5165<\/span><\/a><\/li>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/66.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-66\uff1aSQL\u6ce8\u5165<\/span><\/a><\/li>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/108.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-108\uff1a\u901a\u904eSQL\u6ce8\u5165\u57f7\u884c\u547d\u4ee4\u884c<\/span><\/a><\/li>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/109.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-109\uff1a\u5c0d\u8c61\u95dc\u4fc2\u6620\u5c04\u6ce8\u5165<\/span><\/a><\/li>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/110.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-110\uff1a\u901a\u904eSOAP\u53c3\u6578\u7be1\u6539\u9032\u884cSQL\u6ce8\u5165<\/span><\/a><\/li>\n<li><a href=\"https:\/\/capec.mitre.org\/data\/definitions\/470.html\" target=\"_blank\" rel=\"noopener\"><span style=\"font-size: medium;\">CAPEC-470\uff1a\u5f9e\u6578\u64da\u5eab\u64f4\u5c55\u5c0d\u64cd\u4f5c\u7cfb\u7d71\u7684\u63a7\u5236<\/span><\/a><\/li>\n<\/ul>\n<p>&nbsp;<\/p>\n<p>\u7d9c\u5408\u9019\u5e7e\u7a2e\u985e\u578b\uff0c\u53ef\u4ee5\u5f97\u77e5\u70ba\u9632\u7bc4\u6b64\u653b\u64ca\uff0c\u70ba\u7576\u5916\u90e8\u53c3\u6578\u9032\u5165SQL \u9673\u8ff0\u5f0f(Statement)\u524d\uff0c\u9700\u518d\u7d93\u904e\u9a57\u8b49\u683c\u5f0f\u662f\u5426\u5408\u6cd5\uff0c\u662f\u5426\u6709\u96b1\u85cf\u7279\u6b8a\u7b26\u865f\u7b49\u6aa2\u67e5\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u5e7e\u7a2e\u65b9\u6cd5\uff1a<\/p>\n<p>&nbsp;<\/p>\n<p><strong>\u53c3\u6578\u5316<\/strong><br \/>\n\u5c07\u53c3\u6578\u7d93\u904e Parameter \u6216 Prepare \u7b49\u53ef\u7528\u4f86\u5c0d SQL \u53c3\u6578\u505a\u57f7\u884c\u524d\u7684\u578b\u614b\u8f49\u63db\uff0c\u82e5\u6709\u7279\u6b8a\u5b57\u5143\u5c07\u7121\u6cd5\u7522\u751f\u653b\u64ca\u4f5c\u7528\uff0c\u6700\u70ba\u63a8\u85a6\u6b64\u7a2e\u65b9\u6cd5\uff01<\/p>\n<p><em>.NET<\/em><br \/>\n<em> String query = &#8220;SELECT account_balance FROM user_data WHERE user_name = &#8220;<\/em><br \/>\n<em> + request.getParameter(&#8220;customerName&#8221;);<\/em><\/p>\n<p><em>try {<\/em><br \/>\n<em> Statement statement = connection.createStatement( \u2026 );<\/em><br \/>\n<em> ResultSet results = statement.executeQuery( query );<\/em><br \/>\n<em> }<\/em><\/p>\n<p><em>PHP<\/em><br \/>\n<em> $preparedStatement = $db-&gt;prepare(&#8216;INSERT INTO table (column) VALUES (:column)&#8217;); $preparedStatement-&gt;execute(array(&#8216;column&#8217; =&gt; $unsafeValue));<\/em><\/p>\n<p>&nbsp;<\/p>\n<p><strong>\u66ff\u4ee3\u5b57\u5143<\/strong><br \/>\n\u4f7f\u7528 Replace() \u7b49\u65b9\u6cd5\u4f86\u5c07\u7279\u5b9a\u5b57\u5143\u505a\u66ff\u63db\uff0c\u4f46\u53ef\u80fd\u653b\u64ca\u5b57\u5143\u7a0d\u5fae\u7d93\u904e\u8b8a\u5316\u6216\u52a0\u5bc6\u5f8c\uff0c\u8b8a\u6210\u8aa4\u64cb\u6216\u6f0f\u6a94\u7b49\u7d50\u679c\u3002<\/p>\n<p><em>string sql = &#8220;SELECT * FROM WIDGETS WHERE ID=&#8221; +badValue.Replace(&#8220;&#8216;&#8221;,&#8221;&#8221;&#8221;);<\/em><\/p>\n<p>&nbsp;<\/p>\n<p><strong>\u6b63\u5247\u8868\u9054\u5f0f<\/strong><br \/>\n\u5229\u7528 Regular Expression \u8a2d\u5b9a\u5408\u6cd5\u7684\u683c\u5f0f\uff0c\u76f4\u63a5\u7528\u767d\u540d\u55ae\u65b9\u5f0f\u9650\u5b9a\u53c3\u6578\u7684\u5167\u5bb9\uff0c\u9019\u5c31\u8b8a\u6210\u9700\u6839\u64da\u8cc7\u6599\u7684\u4e0d\u540c\u4f86\u8abf\u6574\u5c0d\u61c9\u7684 Regex\uff0c\u96d6\u7136\u56b4\u8b39\u4f46\u8f03\u70ba\u9ebb\u7169\uff0c\u4f46\u6709\u53ef\u80fd\u7522\u751f\u8aa4\u64cb\u6216\u6f0f\u64cb\u7684\u60c5\u6cc1\u767c\u751f\u3002<\/p>\n<p>&nbsp;<\/p>\n<p>\u4ee5\u4e0a\u5e7e\u7a2e\u9632\u7bc4\u65b9\u6cd5\u9069\u7528\u65bc <a href=\"http:\/\/vscan.local\/blog\/injection-attack\/\">Injection attack<\/a> \u985e\u578b\u7684\u653b\u64ca\u884c\u70ba\uff0c\u53ef\u91dd\u5c0d\u5916\u90e8\u4e0d\u88ab\u4fe1\u4efb\u7684\u53c3\u6578\u505a\u9a57\u8b49\u8207\u904e\u6ffe\u8655\u7406\uff0c\u907f\u514d\u7522\u751f\u4e0d\u53ef\u9810\u671f\u7684\u884c\u70ba\uff0c\u53ef\u8996\u8cc7\u6599\u7684\u591a\u6a23\u6027\u8207\u53c3\u6578\u7528\u9014\u4f86\u9078\u64c7\u76f8\u5c0d\u61c9\u7684\u9632\u79a6\u65b9\u5f0f\u3002<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>SQL Injection \u87ec\u806f OWASP TOP 10 \u51a0\u8ecd\u5bf6\u5ea7\u5f9e2013\u5e74\u7248\u5230\u6700\u65b0\u76842017\u5e74\u7248\uff0c\u53ef\u898b\u5176\u9020\u6210\u7684\u50b7\u5bb3\u53ca\u666e\u904d\u6027\u4e4b\u9ad8\uff0c\u7562\u7adf\u958b\u767c\u4eba\u54e1\u5728\u5c07\u5916\u90e8\u53c3\u6578\u4e1f&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[12,13],"tags":[],"class_list":["post-2357","post","type-post","status-publish","format-standard","hentry","category-injection","category-sql-injection"],"_links":{"self":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2357","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/comments?post=2357"}],"version-history":[{"count":1,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2357\/revisions"}],"predecessor-version":[{"id":2455,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2357\/revisions\/2455"}],"wp:attachment":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/media?parent=2357"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/categories?post=2357"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/tags?post=2357"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}