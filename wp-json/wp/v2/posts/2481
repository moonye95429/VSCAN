{"id":2481,"date":"2018-05-03T18:03:47","date_gmt":"2018-05-03T10:03:47","guid":{"rendered":"http:\/\/vscan.local\/?p=2481"},"modified":"2018-08-04T18:24:21","modified_gmt":"2018-08-04T10:24:21","slug":"csrf-cross-site-request-forgery","status":"publish","type":"post","link":"http:\/\/vscan.local\/blog\/csrf-cross-site-request-forgery\/","title":{"rendered":"CSRF (Cross-Site Request Forgery)"},"content":{"rendered":"<p>CSRF \u70ba\u4e00\u7a2e\u985e\u4f3c\u8a50\u9a19\u7684\u624b\u6cd5\uff0c\u85c9\u7531\u507d\u9020\u7684\u7b2c\u4e09\u65b9\u7db2\u7ad9\u5167\u5bb9\u8a98\u9a19\u53d7\u5bb3\u8005\u9023\u7dda\uff0c\u8a72\u53d7\u5bb3\u8005\u9700\u5df2\u900f\u904e\u8eab\u5206\u9a57\u8b49\u62ff\u5230\u76ee\u6a19\u7db2\u7ad9\u7684 Session\uff0c\u5c0e\u81f4\u5728\u4e0d\u77e5\u60c5\u72c0\u6cc1\u4e0b\uff0c\u53d7\u5bb3\u8005\u958b\u555f\u4e86\u507d\u9020\u7db2\u7ad9\u5f8c\u89f8\u767c\u4e86\u5c0d\u76ee\u6a19\u7db2\u7ad9\u4ee5\u53d7\u5bb3\u8005\u8eab\u5206\u7684\u9023\u7dda\u8981\u6c42\u3002<\/p>\n<p>&nbsp;<\/p>\n<p>\u8a72\u5f31\u9ede\u5c0e\u81f4\u653b\u64ca\u8005\u52ab\u6301\u53d7\u5bb3\u8005\u7684 Session\uff0c\u7b49\u65bc\u653b\u64ca\u8005\u62ff\u5230\u4e86\u53d7\u5bb3\u8005\u7684\u8eab\u5206\uff0c\u4e26\u5728\u4e0d\u77e5\u60c5\u72c0\u6cc1\u4e0b\u88ab\u64cd\u4f5c\u672a\u77e5\u884c\u70ba\uff0c\u53ef\u80fd\u9020\u6210\u53d7\u5bb3\u8005\u7684\u6a5f\u654f\u8cc7\u6599\u6d29\u6f0f\u6216\u4ea4\u6613\u884c\u70ba\u8b8a\u66f4\u7b49\u5f8c\u679c\u3002\u6b64\u653b\u64ca\u884c\u70ba\u8207 <a href=\"http:\/\/vscan.local\/blog\/cross-site-scripting\/\" target=\"_blank\" rel=\"noopener\">XSS<\/a> \u4e0d\u540c\u7684\u5730\u65b9\u5728\u65bc\u672a\u5229\u7528 Script \u53d6\u5f97\u53d7\u5bb3\u8005\u6a5f\u5bc6\u8cc7\u8a0a\uff0c\u800c\u662f\u76f4\u63a5\u5229\u7528\u53d7\u5bb3\u8005\u767c\u51fa\u7684\u9023\u7dda\u9032\u884c\u64cd\u4f5c\uff0c\u56e0\u6b64\u9664\u4e86 Cookie \u7684\u4fdd\u8b77\u5916\uff0c\u4e5f\u5fc5\u9808\u5c0d\u6a5f\u654f\u5167\u5bb9\u7684\u9023\u7dda\u505a\u4e8c\u6b21\u9a57\u8b49\uff0c\u63a1\u7528\u4e0d\u4fe1\u4efb\u7684\u65b9\u5f0f\u6aa2\u67e5\u3002<\/p>\n<p>&nbsp;<\/p>\n<figure id=\"attachment_2483\" aria-describedby=\"caption-attachment-2483\" style=\"width: 592px\" class=\"wp-caption aligncenter\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-2483\" src=\"http:\/\/vscan.local\/wp-content\/uploads\/2018\/08\/csrf.jpg\" alt=\"CSRF\" width=\"592\" height=\"309\" srcset=\"http:\/\/vscan.local\/wp-content\/uploads\/2018\/08\/csrf.jpg 592w, http:\/\/vscan.local\/wp-content\/uploads\/2018\/08\/csrf-300x157.jpg 300w, http:\/\/vscan.local\/wp-content\/uploads\/2018\/08\/csrf-239x125.jpg 239w\" sizes=\"auto, (max-width: 592px) 100vw, 592px\" \/><figcaption id=\"caption-attachment-2483\" class=\"wp-caption-text\">Cross-Site Request Forgery<\/figcaption><\/figure>\n<p>&nbsp;<\/p>\n<p>\u9a57\u8b49\u7684\u65b9\u5411\u9700\u80fd\u6aa2\u9a57\u9001\u51fa\u9023\u7dda\u7684\u4f7f\u7528\u8005\u8eab\u5206\uff0c\u4ee5\u907f\u514d\u53d7\u5bb3\u8005\u5728\u4e0d\u77e5\u60c5\u72c0\u6cc1\u4e0b\u88ab\u5192\u7528\u8eab\u5206\uff0c\u53ef\u53c3\u8003\u65b9\u6cd5\u5982\u4e0b\uff0c<\/p>\n<ul>\n<li>\n<h4><strong> \u6aa2\u67e5 <a href=\"http:\/\/vscan.local\/blog\/http-header-security\/\" target=\"_blank\" rel=\"noopener\">HTTP Header<\/a> \u6b04\u4f4d<\/strong>\uff1a\u53ef\u900f\u904e\u6aa2\u67e5 Header \u4e2d\u7684 Referer \u6b04\u4f4d\u662f\u5426\u5b58\u5728\u53ca\u662f\u5426\u70ba\u6b63\u5e38\u6d41\u7a0b\u7db2\u57df\uff0c\u85c9\u6b64\u78ba\u8a8d\u767c\u9001\u7aef\u7684\u524d\u4e00\u500b\u9801\u9762\u662f\u5426\u88ab\u507d\u9020\u6216\u5408\u6cd5\u4f7f\u7528\u3002<\/h4>\n<\/li>\n<li>\n<h4><strong>\u9a57\u8b49 Token \u53c3\u6578<\/strong>\uff1a\u9664\u4e86\u9a57\u8b49 Cookie \u7684 Token \u4e4b\u5916\uff0c\u9084\u9700\u53e6\u5916\u5728 Request \u4e2d\u653e\u5165\u96b1\u85cf\u7684\u52d5\u614b Token \u53c3\u6578\u3002<\/h4>\n<\/li>\n<li>\n<h4><strong>\u8fa8\u8b58\u4f7f\u7528\u8005\u8cc7\u8a0a<\/strong>\uff1a\u53d6\u5f97\u4f7f\u7528\u8005\u74b0\u5883\u8cc7\u8a0a\u5982 IP \u4f4d\u5740\u6216\u700f\u89bd\u5668\u7684 User-Agent\uff0c\u82e5\u767c\u73fe\u7d93\u8b8a\u66f4\u5373\u9a57\u8b49\u5931\u6548\u6216\u9001\u51fa\u91cd\u8907\u8eab\u4efd\u9a57\u8b49\u9700\u6c42\u3002<\/h4>\n<\/li>\n<\/ul>\n<p>&nbsp;<\/p>\n<p>.NET \u958b\u767c\u8005\u53ef\u53c3\u8003\u5982\u4e0b\u65b9\u6cd5\u4f86\u9032\u884c\uff1a<\/p>\n<p>\u53d6\u5f97 Referer \u6a19\u982d (HttpRequest.UrlReferrer \/ HttpWebRequest.Referer)<\/p>\n<p><a href=\"https:\/\/msdn.microsoft.com\/zh-tw\/library\/system.net.httpwebrequest.referer(v=vs.110).aspx\" target=\"_blank\" rel=\"noopener\"><em>https:\/\/msdn.microsoft.com\/zh-tw\/library\/system.net.httpwebrequest.referer(v=vs.110).aspx<\/em><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>\u4f7f\u7528 ASP .NET Core \u7684 Antiforgery \u9632\u7bc4<\/p>\n<p><a href=\"https:\/\/docs.microsoft.com\/zh-tw\/aspnet\/core\/security\/anti-request-forgery\" target=\"_blank\" rel=\"noopener\"><em>https:\/\/docs.microsoft.com\/zh-tw\/aspnet\/core\/security\/anti-request-forgery<\/em><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>\u53d6\u5f97\u4f7f\u7528\u8005\u8cc7\u8a0a (User-Agent)<\/p>\n<p><a href=\"https:\/\/msdn.microsoft.com\/zh-tw\/library\/system.web.httprequest.useragent(v=vs.110).aspx\" target=\"_blank\" rel=\"noopener\"><em>https:\/\/msdn.microsoft.com\/zh-tw\/library\/system.web.httprequest.useragent(v=vs.110).aspx<\/em><\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>CSRF \u70ba\u4e00\u7a2e\u985e\u4f3c\u8a50\u9a19\u7684\u624b\u6cd5\uff0c\u85c9\u7531\u507d\u9020\u7684\u7b2c\u4e09\u65b9\u7db2\u7ad9\u5167\u5bb9\u8a98\u9a19\u53d7\u5bb3\u8005\u9023\u7dda\uff0c\u8a72\u53d7\u5bb3\u8005\u9700\u5df2\u900f\u904e\u8eab\u5206\u9a57\u8b49\u62ff\u5230\u76ee\u6a19\u7db2\u7ad9\u7684 Session\uff0c\u5c0e\u81f4\u5728\u4e0d\u77e5\u60c5\u72c0\u6cc1\u4e0b\uff0c\u53d7\u5bb3\u8005\u958b\u555f\u4e86&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[10,11,9],"tags":[],"class_list":["post-2481","post","type-post","status-publish","format-standard","hentry","category-cross-site-scripting","category-csrf","category-http-header"],"_links":{"self":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2481","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/comments?post=2481"}],"version-history":[{"count":10,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2481\/revisions"}],"predecessor-version":[{"id":2492,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/posts\/2481\/revisions\/2492"}],"wp:attachment":[{"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/media?parent=2481"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/categories?post=2481"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/vscan.local\/wp-json\/wp\/v2\/tags?post=2481"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}