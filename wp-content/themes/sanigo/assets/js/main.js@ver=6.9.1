( function( $ ) {

    "use strict";
    var $ds               = jQuery.noConflict();
    var $jk               = $ds(document);
    var $wd               = $(window);


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Flexible videos with fitvids
    / ----------------------------------------------------------------------------
    */
    $.fn.initFitvids = function () {
        $ds(".audio-wrapper").fitVids();
        $ds(".video-wrapper").fitVids();
        $ds(".post-featured-video").fitVids();
        $ds(".section-video-wrapper").fitVids();
        $ds(".post-featured-video").fitVids();
    };

    


    /* 
    \ ----------------------------------------------------------------------------
     | Add Margin Bottom to content Wrapper if the footer is fixed
    / ----------------------------------------------------------------------------
    */
    $.fn.fixedFooter = function() {

      var footer = $(".footer");
      var windowWidth = $(window).width();

      if ( $(".footer").attr("fixed-footer") == "true" && windowWidth > 770) {
        $(".main_content_wrapper").css("margin-bottom",footer.height() + "px" );
      }
    };

    
    /* 
    \ ----------------------------------------------------------------------------
     | Insert a min height for flipboxes
    / ----------------------------------------------------------------------------
    */
    $.fn.setFlipboxHeight = function() {

      $ds( ".flipbox-container" ).each( function() {

        var element = $(this);
        var frontHeight = element.find(".flipbox-front").height();
        var backHeight = element.find(".flipbox-back").height();
        var minHeight = null;

        if ( frontHeight >= backHeight )
          minHeight = frontHeight;
        else 
          minHeight = backHeight;
        element.css("min-height",minHeight+"px");
      });
    };

    
    /* 
    \ ----------------------------------------------------------------------------
     | Initialize portfolio isotope
    / ----------------------------------------------------------------------------
    */
    $.fn.initIsotopePortfolio = function() {
      if(jQuery().isotope) {
        $ds(".portfolio-grid,.portfolio-elastic").imagesLoaded(function(){
          var portfolio = $ds(".portfolio-grid,.portfolio-elastic").isotope({
            itemSelector: ".portfolio-col",
            layoutMode: "masonry",
            stagger: 30,
            getSortData: {
              name: ".portfolio-title",
              category: "[data-category]"
            }
          });
        });
        $( ".filter-inner .filter span" ).click(function() {
          $('.filter').removeClass("is-checked")
          $(this).parent().addClass( "is-checked" );
        });
        $('.filter-inner').on( 'click', '.filter', function() {
          var filterValue = $(this).attr('data-filter');
          $ds(".portfolio-grid").isotope({ filter: filterValue });
        });
      }
       
    };



    
    /* 
    \ ----------------------------------------------------------------------------
     | Woocommerce Add to Cart Effect
    / ----------------------------------------------------------------------------
    */
    $.fn.addToCart = function () {
      $("body").on("click", ".add_to_cart_button", function () {
        var product = $(this).closest(".product-item").addClass("adding-to-cart").removeClass("added-to-cart");
      });

      $("body").bind("added_to_cart", function () {
        $(".adding-to-cart").removeClass("adding-to-cart").addClass("added-to-cart");
      });
    };

    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize prettyphoto for gallery
    / ----------------------------------------------------------------------------
    */
    $.fn.initPrettyphoto = function() {

      $("[data-gal^='prettyPhoto'], .prettyphoto").prettyPhoto({
          social_tools:false,
          animation_speed:"normal",
          slideshow:false,
          deeplinking: false,
          show_title: true,
          overlay_gallery: false,
      });

    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Getting lating and longue of a given address
    / ----------------------------------------------------------------------------
    */
    function getLatLng (address, callback) { 

      var geocoder = new google.maps.Geocoder(); 

      geocoder.geocode({"address":address},   function(results, status){ 
           if (status == google.maps.GeocoderStatus.OK) { 
                window.coordinates = [results[0].geometry.location.lat(), results[0].geometry.location.lng()];
                callback (coordinates); 
            } 
        }); 
    }



    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Google Maps
    / ----------------------------------------------------------------------------
    */
    $.fn.initMaps = function() {
        
        $ds(".map-container").each(function(i,el){

            var options,
                mapc = this,
                element                 = $(this).get(0),
                mapInfo                 = JSON.parse($ds(this).attr("data-map-params")),
                mapColor                = mapInfo.color || null,
                mapType                 = mapInfo.type || null,
                mapDraggable            = mapInfo.draggable || true,
                mapStyle                = mapInfo.style || null,
                mapScrollwheel          = mapInfo.scrollwheel || true,
                mapZoom                 = mapInfo.zoom || 8,
                mapAddress              = mapInfo.address || null,
                mapZoomMax              = mapInfo.zoomMax || 100,
                mapZoomMin              = mapInfo.zoomMin || 1,
                mapRotateControl        = mapInfo.rotateControl || true,
                mapPanControl           = mapInfo.panControl || true,
                mapZoomControl          = mapInfo.zoomControl || true,
                mapScaleControl         = mapInfo.scaleControl || true,
                mapNavigationControl    = mapInfo.navigationControl || true,
                mapTypeControl          = mapInfo.mapTypeControl || true,
                mapScaleControl         = mapInfo.scaleControl || true,
                mapStreetViewControl    = mapInfo.streetViewControl || false,
                mapMarkerIcon           = mapInfo.markerIcon,
                mapInfobox              = mapInfo.infobox || null;

            var styles = null;

            mapDraggable          = ( mapDraggable == "false" ) ? false : true;
            mapScrollwheel        = ( mapScrollwheel == "false" ) ? false : true;
            mapRotateControl      = ( mapRotateControl == "false" ) ? false : true;
            mapPanControl         = ( mapPanControl == "false" ) ? false : true;
            mapZoomControl        = ( mapZoomControl == "false" ) ? false : true;
            mapScaleControl       = ( mapScaleControl == "false" ) ? false : true;
            mapNavigationControl  = ( mapNavigationControl == "false" ) ? false : true;
            mapTypeControl        = ( mapTypeControl == "false" ) ? false : true;
            mapScaleControl       = ( mapScaleControl == "false" ) ? false : true;
            mapStreetViewControl  = ( mapStreetViewControl == "true" ) ? true : false;

            var geocoder = new google.maps.Geocoder();
            
            if ( mapStyle == "dark") {
                var styles=[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}];
            } 
            else if ( mapStyle == "light" ) {
                var styles=[{featureType:"all",elementType:"all",stylers:[{gamma:"0.83"},{saturation:"-86"}]},{featureType:"all",elementType:"geometry",stylers:[{saturation:"-31"},{lightness:"15"}]},{featureType:"all",elementType:"geometry.fill",stylers:[{saturation:"-99"}]},{featureType:"all",elementType:"labels",stylers:[{saturation:"-63"},{gamma:"1.14"}]},{featureType:"all",elementType:"labels.text",stylers:[{gamma:"0.92"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{gamma:"1.29"},{saturation:"-6"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{gamma:"1.00"}]},{featureType:"all",elementType:"labels.icon",stylers:[{weight:"0.01"},{gamma:"0.00"},{lightness:"-29"},{saturation:"-82"}]},{featureType:"administrative.country",elementType:"all",stylers:[{gamma:"1.00"}]}];
            } 
            else if ( mapStyle == "colorlight") {
                var styles = [{featureType:"all",elementType:"geometry",stylers:[{visibility:"simplified"},{hue:"#ff7700"}]},{featureType:"administrative",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#1d1d1d"}]},{featureType:"administrative.province",elementType:"labels.text.fill",stylers:[{color:"#ffffff"},{visibility:"on"}]},{featureType:"administrative.province",elementType:"labels.text.stroke",stylers:[{color:mapColor},{weight:"5.00"},{visibility:"on"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#787878"},{visibility:"on"}]},{featureType:"administrative.locality",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{visibility:"on"},{weight:"5.00"}]},{featureType:"administrative.neighborhood",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#2d2d2d"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{visibility:"on"},{weight:"5.00"}]},{featureType:"administrative.land_parcel",elementType:"geometry.fill",stylers:[{saturation:"64"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#fafafa"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#d5d5d5"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"},{color:"#ff0000"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:mapColor}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{weight:"5.00"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:mapColor},{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"on"},{color:mapColor}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:mapColor}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#d9d9d9"},{visibility:"on"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{visibility:"simplified"},{lightness:"4"},{saturation:"-100"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#e1e1e1"},{visibility:"on"}]}];
            } 
            else if ( mapStyle == "colordark") {
                var styles = [{featureType:"all",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:mapColor}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#c4c4c4"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:mapColor}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21},{visibility:"on"}]},{featureType:"poi.business",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:mapColor},{lightness:"0"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:mapColor}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#575757"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{color:"#2c2c2c"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}];
            } 
            else if ( mapStyle == "bluewater" ) {
                var styles = [{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}];
            }
            else if ( mapStyle == "colored" ) {
                    var styles = [{stylers:[{hue:mapColor},{saturation:250}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:50},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}];
            }

            if ( mapType == "satellite" ) {
                var mapTypeId = google.maps.MapTypeId.SATELLITE;
            } 
            else if ( mapType == "terrain") {
                var mapTypeId = google.maps.MapTypeId.TERRAIN;
            } 
            else if ( mapType == "hybrid") {
                var mapTypeId = google.maps.MapTypeId.HYBRID;
            } 
            else {
                var mapTypeId = google.maps.MapTypeId.ROADMAP;
            }

            getLatLng( mapAddress, function( coordonates ) { 

              options = {
                center: {
                  lat: coordonates[0],
                  lng: coordonates[1]
                },
                styles: styles,
                mapTypeId: mapTypeId,
                draggable: mapDraggable,
                navigationControl: mapNavigationControl,
                mapTypeControl: mapTypeControl,
                zoom: mapZoom,
                scrollwheel: mapScrollwheel,
                maxZoom: mapZoomMax,
                minZoom: mapZoomMin,
                rotateControl: mapRotateControl,
                panControl: mapPanControl,
                zoomControl: mapZoomControl,
                scaleControl: mapScaleControl,
                streetViewControl: mapStreetViewControl
              };

              var map = new google.maps.Map(element, options);

              var marker = new google.maps.Marker({
                  position: {
                    lat: coordonates[0],
                    lng: coordonates[1]
                  },
                  map: map,
                  title: "Hello Word",
                  icon: mapMarkerIcon
              });

              if ( mapInfobox != null ) {

                  var infoWindow = new google.maps.InfoWindow({
                    content: mapInfobox
                  }); 
                  
                  google.maps.event.addListener(marker, "click", function() {
                    infoWindow.open(map,marker);
                  });
              }
              
            });
        });
    };
    
   

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Nicescroll plugin
    / ----------------------------------------------------------------------------
    */
    $.fn.initNiceScroll = function () {
        if ( $ds("body").hasClass("nicescroll_active")) {
          $ds("html").niceScroll({
            scrollspeed: $ds("body").data("scroll-speed"),
            touchbehavior: $ds("body").data("scroll-touchbehavior"),
            cursorwidth: $ds("body").data("scroll-cursorwidth") + "px",
            cursorcolor: $ds("body").data("scroll-cursorcolor")
          });
        }
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Tabs
    / ----------------------------------------------------------------------------
    */
    $.fn.InitTabs = function() {
      $ds( ".tabs" ).tabs();
    }
    

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Accordions
    / ----------------------------------------------------------------------------
    */
    $.fn.InitAccordion = function() {
     
        $ds(".accordion-holder").each(function(){

            var el = $(this);
            
            if( el.hasClass("openAll") ){
                
                el.find(".accordion-item")
                  .addClass("open")
                  .children(".accordion-item-content")
                  .show();
                
            } else {
                var activeTab = el.data("active-tab");
                if( el.hasClass("openfirst") ) activeTab = 1;
                
                if( activeTab ){
                    el.find(".accordion-item")
                        .eq( activeTab - 1 )
                        .addClass("open")
                        .children(".accordion-item-content")
                        .show();
                }
                
            }   
        });
        $(".accordion-holder .accordion-item > .accordion-item-header").click(function(){      
            if($(this).parent().hasClass("open")) {
                $(this).parent()
                        .removeClass("open")
                        .children(".accordion-item-content")
                        .slideToggle(200);
            }
            else
            {
                if( ! ($(this).closest(".accordion-holder").data("toggle") == "toggle") ){
                    $(this).parents(".accordion-holder").children().each(function() {
                        if($(this).hasClass("open")) {
                            $(this).removeClass("open")
                                    .children(".accordion-item-content")
                                    .slideToggle(200);
                        }
                    });
                }
                $(this).parent().addClass("open");
                $(this).next(".accordion-item-content").slideToggle(200);
            }
        });
    };
    
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize FlexSlider
    / ----------------------------------------------------------------------------
    */
    $.fn.initFlexSlider = function() {
        $ds(".flexslider").flexslider({
            animation: "fade",
            directionNav: true,
            prevText:"<div><span class=\"fa fa-angle-left\"></span></div>",
            nextText:"<div><span class=\"fa fa-angle-right\"></span></div>",
            controlNav: false,
            start: function(slider){
              $ds("body").removeClass("loading");
            }
        });
    };
    



    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Pie Charts
    / ----------------------------------------------------------------------------
    */
    $.fn.initEasyPieChart = function () {
      $ds(".chart").waypoint({
        offset      : "100%",
        triggerOnce : true,
        handler     : function(){
            
          var color           = $ds(this).data("color");
          var size            = $ds(this).data("size") || 180;
          var linecap         = $ds(this).data("line-cap") || "circle";
          var linewidth       = $ds(this).data("line-width") || 8;
          var scalecolor      = $ds(this).data("scale-color") || false;
          var scalelength     = $ds(this).data("scale-length") || 5;
          var trackcolor      = $ds(this).data("track-color") || false;
          var rotate          = $ds(this).data("rotate") || 0;

          $ds(this).easyPieChart({
              animate     : 1000,
              barColor    : color,
              lineCap     : linecap,
              lineWidth   : linewidth,
              size        : size,
              scaleColor  : scalecolor,
              scaleLength : scalelength,
              trackColor  : trackcolor,
              rotate      : rotate
          });
        }
      });
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize One Page Scroll
    / ----------------------------------------------------------------------------
    */
    $.fn.initPageScroll = function() {
      if ( $("body").hasClass("one-page") ) {
        var menuHeight = $(".header-main-wrapper").height();
        var sections   = $(".section"); 
        var mainMenu   = $(".main-menu");

        $(".main-menu  a[href*=#]").on("click", function(e){    
          e.stopPropagation(); 
          e.preventDefault();
          var scrollTop =  $(this.hash).offset().top - menuHeight;
          $("html, body").animate({
                    scrollTop: scrollTop
                    }, 400, "easeInQuart");
          $(this).blur();
        });

         
        $(window).on("scroll", function () {

          var cursorPosition = $(this).scrollTop();
         
          sections.each(function() {
            var topOffset = $(this).offset().top - ( menuHeight + 1 );
            var bottomOffset = topOffset + $(this).outerHeight();
         
            if (cursorPosition >= topOffset && cursorPosition <= bottomOffset) {
              mainMenu.find("li").removeClass("current-page-ancestor");
         
              $(this).addClass("current-page-ancestor");
              mainMenu.find("a[href=\"#"+$(this).attr("id")+"\"]").parent().addClass("current-page-ancestor");
            }
          });
        });
      } 
    }
    

    /* 
    \ ----------------------------------------------------------------------------
     | Side Header Functionality
    / ----------------------------------------------------------------------------
    */
    $.fn.sideHeaderNavigation = function() {

      
      
    }();

   
    /* 
    \ ----------------------------------------------------------------------------
     | Toggle Superfish
    / ----------------------------------------------------------------------------
    */
    $.fn.toggleSF = function() {

      $(".no-mega-menu").each(function(){
          $(this).parent().addClass("no-mega-menu-parent-item");
        });
      if(!$(".main-menu").hasClass("etm-dropdown") ){
        $(".main-menu").addClass("etm-dropdown");
      }
      $ds(".etm-dropdown").superfish({
        delay:        700,
        hoverClass:     "etm-hover",
        animation:     {opacity:"show"},  
        speed:        200,
        speedOut:     0,
        cssArrows:    false
      });
    };



    /* 
    \ ----------------------------------------------------------------------------
     | Choose Sub Menu correct Position
    / ----------------------------------------------------------------------------
    */
    $.fn.subMenuPosition = function() {

      var $ww = $(window).width();
      var $hasSubMenu;
      var $subMenuWidth;
      var $subMenuOffset;
      var $newPos;

      $(".main-menu .no-mega-menu").on("mouseover",function(){

        $hasSubMenu = $(this).find(".sub-menu").length;

        if($hasSubMenu > 0 ){

          $subMenuWidth = $(this).find(".sub-menu").width();
          $subMenuOffset = $(this).find(".sub-menu").parent().offset().left + $subMenuWidth;

          if( ( $subMenuOffset + $subMenuWidth ) > $ww ){

             $newPos = $subMenuWidth;

             $(this).find(".sub-menu").css({
                 left: -$newPos
             });

          }
        }
      });
    };

    

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Mobile Menu
    / ----------------------------------------------------------------------------
    */
    $.fn.initMobileMenu = function(){
          $(".mobile-menu .menu-item.menu-item-has-children > a > i.mobile-menu-icon").on("click",function(e){
            e.stopPropagation();
            e.preventDefault();
            $(this).parent().siblings(".sub-menu").stop(false,true)
                                         .slideToggle(400,"easeOutBack")
                                         .toggleClass("open");
          });
          $(".mobile-menu-toggle").on("click",function(e){
            e.stopPropagation();
            e.preventDefault();
              $(".mobile-menu").stop(false,true)
                               .slideToggle(400,"easeOutBack")
                               .toggleClass("visible");
              return false;
          });
      
    };



    /* 
    \ ----------------------------------------------------------------------------
     | Adapt Menu for all screen sizes
    / ----------------------------------------------------------------------------
    */
    $.fn.adaptMenu = function() {

      var $width = $(".main-menu-container").width();
      var $logow = $(".logo-wrapper").width()
      var $maxWidth = $width + $(".logo-wrapper").width();
      var $headerWidth = $(".header-main").width();
      var $responsiveState  = ( $(".header-wrapper").attr("data-responsive-state") ) ? $(".header-wrapper").attr("data-responsive-state") : 768;

      var container = $(".main-menu-container").closest(".header-main-wrapper");

      if($wd.width() < $responsiveState){
        $(".mobile-menu-toggle").removeClass("hidden-h").addClass("visible-h");
        $(".main-menu").removeClass("visible-h").addClass("hidden-h");
        if ( ! $(".header-main-wrapper").hasClass("mobile-menu-wrapper") ) {
          $(".header-main-wrapper").addClass("mobile-menu-wrapper");
          $("body").trigger("is_mobile_menu");
        }

        $ds(".mobile-menu .menu-item").each(function(){
            $ds(this).has(".sub-menu").addClass("has-children");
        });

        if ( $(".header-main-wrapper").hasClass("mobile-menu-wrapper") ) {
            $("#header").css({"height":"auto"});
          }
      } 
      else 
      {
          $(".mobile-menu-toggle").removeClass("visible-h").addClass("hidden-h");
          if ( $(".main-menu-container").hasClass("mobile-menu") ) {
            $(".main-menu-container").removeClass("mobile-menu");
          }
          if ( $(".header-main-wrapper").hasClass("mobile-menu-wrapper") ) {
            $(".header-main-wrapper").removeClass("mobile-menu-wrapper");
          }
          $(".main-menu-container .main-menu").removeClass("hidden-h").addClass("visible-h");
      }

    };



    /* 
    \ ----------------------------------------------------------------------------
     | Sticky Header Functionality
    / ----------------------------------------------------------------------------
    */
    $.fn.stickyMenu = function() {
        $(".mega-menu-header-below:has(ul)").each(function(){
            $(this).find('.mega-menu-header-below').each(function(){
              $(this).removeClass("mega-menu-header-below");
            });
        });
        $(".mega-menu-header-classic:has(ul)").each(function(){
            $(this).find('.mega-menu-header-classic').each(function(){
              $(this).removeClass("mega-menu-header-classic");
            });
        });
        
        var body = $ds("body");
        var headerMainWrapper = $ds(".header-main-wrapper");
        var headerMain      = $ds(".header-main");
        var headerBackground =  $(".header-background");
        var logoWrapper = $ds(".logo-wrapper");
        var headerInfo = $ds(".header-info");
        var headerHeight;
        var $responsiveState  = ( $(".header-wrapper").attr("data-responsive-state") ) ? $(".header-wrapper").attr("data-responsive-state") : 768;

        if ( $(".unity-rev-slider").length ) {
          headerBackground = $(".unity-rev-slider");
        } 
        else if ( $(".unity-layer-slider").length ) {
          headerBackground = $(".unity-layer-slider");
        }

        if( headerMainWrapper.hasClass("header-bottom") ) {
            headerHeight = headerMainWrapper.innerHeight() + headerBackground.innerHeight() + headerInfo.innerHeight();
        } 

        else if ( headerMainWrapper.hasClass("header-light") ||
                  headerMainWrapper.hasClass("header-dark") ||
                  headerMainWrapper.hasClass("header-semitransparent-light") ||
                  headerMainWrapper.hasClass("header-semitransparent-dark") ) {

            headerHeight = headerMainWrapper.innerHeight();
        } 
        else if ( headerMainWrapper.hasClass("header-default") ||
                    headerMainWrapper.hasClass("header-modern") ||
                    headerMainWrapper.hasClass("header-transparent") ) {

            headerHeight = headerMainWrapper.innerHeight() + headerInfo.innerHeight();
        } 
        else if ( headerMainWrapper.hasClass("header-stack") ) {
            headerHeight = $(".header-main-wrapper > .container-fluid,.header-main-wrapper > .container").innerHeight() + headerInfo.innerHeight();
        }
        else {
            headerHeight = 82;
        }


        if ( body.hasClass("header-sticky") ) {
            var startY = headerHeight;
            var windowY = $wd.scrollTop();
            var headerHeight;
            var top;
            
            if ( $(window).width() > 1000) {
                if ( windowY > startY ) {
                    if ( ! (headerMainWrapper.hasClass("is-sticky")) && 
                           ! ( headerMainWrapper.hasClass("header-dark") || headerMainWrapper.hasClass("header-light")  || headerMainWrapper.hasClass("header-side")
                            || headerMainWrapper.hasClass("header-semitransparent-dark") || headerMainWrapper.hasClass("header-semitransparent-light")) ) {
                        headerMainWrapper.addClass("is-sticky").
                                css("top",-80).
                                    animate({
                                        "top": 0
                                    },300);
                    }
                }
                else {
                    if ( headerMainWrapper.hasClass("is-sticky") ) {
                      headerMainWrapper.removeClass("is-sticky");
                    }
                    if ( (headerMainWrapper.hasClass("header-modern") || headerMainWrapper.hasClass("header-transparent")) && $(".header-info").length ){
                      headerMainWrapper.css("top","42px");
                    } 
                    headerHeight = 0;
                    if ( ( headerMainWrapper.hasClass("header-default") && ! headerMainWrapper.hasClass("header-bottom") ) || headerMainWrapper.hasClass("header-stack") ) {
                      headerHeight = $(".header-main-wrapper > .container-fluid,.header-main-wrapper > .container").innerHeight()+$(".header-info").innerHeight();
                      $("#header").css("height", headerHeight+"px");
                    } 
                    else if ( headerMainWrapper.hasClass("header-bottom")) {
                      headerHeight = headerMainWrapper.innerHeight() + headerBackground.innerHeight() + headerInfo.innerHeight();
                      $("#header").css("height", headerHeight+"px");
                    }
                    if ( headerMainWrapper.hasClass("header-transparent") ) {

                    }
                    
                }
              }
              else if( $(window).width() < $responsiveState) {
                $("#header").css({"height":"auto"});
                headerMainWrapper.css("top","0px");
                if ( headerMainWrapper.hasClass("is-sticky"))
                  headerMainWrapper.removeClass("is-sticky");
              }
              else {
                if ( headerMainWrapper.hasClass("is-sticky") ) {
                  headerMainWrapper.removeClass("is-sticky");
                  if ( headerMainWrapper.hasClass("header-modern")){
                    headerMainWrapper.css("top","42px");
                  } 
                } 
                if ( headerMainWrapper.hasClass("header-modern") ) {
                  headerMainWrapper.css("top","42px");
                }
              }
              $(window).resize(function(){
                if ( ! headerMainWrapper.hasClass("is-sticky") && headerMainWrapper.hasClass("header-modern")) {
                  if ( $(window).width() < $responsiveState ) {

                    headerMainWrapper.css("top",0);
                  }
                  else {
                    headerMainWrapper.css("top","42px");
                  }
                }
                headerHeight = 0;
                if ( headerMainWrapper.hasClass("header-default") || headerMainWrapper.hasClass("header-stack") ) {
                  headerHeight = $(".header-main-wrapper > .container-fluid,.header-main-wrapper > .container").height() + $(".header-info").height();
                  if ( $(window).width() > $responsiveState) {
                    $("#header").css("height", headerHeight+"px");
                  }
                } 
                if ( windowY <= startY ) {
                  if ( headerMainWrapper.hasClass("is-sticky"))
                    headerMainWrapper.removeClass("is-sticky");
                }
              });
        }
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize mediaelement plugin for video and audio players
    / ----------------------------------------------------------------------------
    */
    $.fn.initMediaElement = function() {
        
        $ds(".audio,.video").each(function(){
          if ( $ds(this).find("source").attr("src") != null ) {
            $ds(this).mediaelementplayer({
                enableKeyboard: false,
                iPadUseNativeControls: false,
                pauseOtherPlayers: false,
                iPhoneUseNativeControls: false,
                AndroidUseNativeControls: false,
                alwaysShowControls: true,
                features: ["playpause","progress","current","duration","tracks","volume"]
            });
          }
        });
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Insert Gradient colors for a given section
    / ----------------------------------------------------------------------------
    */
    $.fn.insertGradientColor = function () {

        var gradient = $ds(".gradient");
        gradient.each(function( i ) {

            // Color properties
            var colorIn  = $ds(this).data("color-in");
            var colorOut = $ds(this).data("color-out");

            // Browsers check
            var isOpera = !!window.opera || navigator.userAgent.indexOf(" OPR/") >= 0;
            var isFirefox = typeof InstallTrigger !== "undefined";   
            var isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor") > 0;
            var isChrome = !!window.chrome && !isOpera;             
            var isIE = /*@cc_on!@*/false || !!document.documentMode;

            // Check if the browser used is firefox
            if ( isFirefox ) {

                // Check if the gradient section has the class gradient-horizontal

                if ( $ds(this).hasClass("gradient-horizontal") ) {

                    $ds(this).css(
                        "background-image" , "-moz-linear-gradient(left, " + colorIn + ", " + colorOut + ")"
                    );
                }

                // Check if the gradient section has the class gradient-vertical

                if ( $ds(this).hasClass("gradient-vertical") ) {

                    $ds(this).css(
                        "background", "-moz-linear-gradient(top, " + colorIn + ", " + colorOut + ")"
                    );
                }    

                // Check if the gradient section has the class gradient-diagonal

                if ( $ds(this).hasClass("gradient-diagonal") ) {

                    $ds(this).css(
                        "background", "-moz-linear-gradient(45deg, " + colorIn + ", " + colorOut + ")"
                    );
                } 

                // Check if the gradient section has the class gradient-diagonal-inverse

                if ( $ds(this).hasClass("gradient-diagonal-inverse") ) {

                    $ds(this).css(
                        "background", "-moz-linear-gradient(-45deg, " + colorIn + ", " + colorOut + ")"
                    );
                }  

                // Check if the gradient section has the class gradient-radial

                if ( $ds(this).hasClass("gradient-radial") ) {

                    $ds(this).css(
                        "background", "-moz-radial-gradient(center, ellipse cover, " + colorIn + ", " + colorOut + ")"
                    );
                }    
                
            // Check if the browser used is opera        
            } 
            else if ( isOpera ) {
                // Check if the gradient section has the class gradient-horizontal
                if ( $ds(this).hasClass("gradient-horizontal") ) {
                    gradientHorizontal.css(
                        "background" , "linear-gradient(to right," + colorIn + " 0%, " + colorOut + " 100%)"
                    );
                }
                
                // Check if the gradient section has the class gradient-vertical
                if ( $ds(this).hasClass("gradient-vertical") ) {
                    gradientVertical.css(
                        "background", "linear-gradient(" + colorIn + " 0%, " + colorOut + " 100%)"
                    );
                }
                
                // Check if the gradient section has the class gradient-diagonal   
                if ( $ds(this).hasClass("gradient-diagonal") ) {
                    gradientDiagonal.css(
                        "background", "linear-gradient(45deg, " + colorIn + " 0%, " + colorOut + " 100%)"
                    );
                }

                // Check if the gradient section has the class gradient-diagonal-inverse
                if ( $ds(this).hasClass("gradient-diagonal-inverse") ) {
                    gradientDiagonalInverse.css(
                        "background", "linear-gradient(-45deg, " + colorIn + " 0%, " + colorOut + " 100%)"
                    );
                }
                
                // Check if the gradient section has the class gradient-radial   
                if ( $ds(this).hasClass("gradient-radial") ) {
                    gradientRadial.css(
                        "background", "radial-gradient(at 50% 50%, " + colorIn + " 0%," + colorOut + " 100%)"
                    );
                }
            
            // Check if the browser used is safari or chrome    
            } 
            else if ( isSafari || isChrome ) {
                // Check if the gradient section has the class gradient-horizontal
                if ( $ds(this).hasClass("gradient-horizontal") ) {
                    $ds(this).css({
                        "background" : "-webkit-gradient(linear, left top, right top, from(" + colorIn + "), to(" + colorOut + "))"
                    });  
                }

                // Check if the gradient section has the class gradient-vertical
                if ( $ds(this).hasClass("gradient-vertical") ) {
                    $ds(this).css({
                        "background" : "-webkit-gradient(linear, left top, left bottom, from(" + colorIn + "), to(" + colorOut + "))"
                    }); 
                }

                // Check if the gradient section has the class gradient-diagonal
                if ( $ds(this).hasClass("gradient-diagonal") ) {
                    $ds(this).css(
                        "background", "-webkit-gradient(linear, left bottom, right top, from(" + colorIn + "), to(" + colorOut + "))"
                    );
                }

                // Check if the gradient section has the class gradient-diagonal-inverse
                if ( $ds(this).hasClass("gradient-diagonal-inverse") ) {
                    $ds(this).css(
                        "background", "-webkit-gradient(linear, right bottom, left top, from(" + colorIn + "), to(" + colorOut + "))"
                    );
                }

                // Check if the gradient section has the class gradient-radial 
                if ( $ds(this).hasClass("gradient-radial") ) {
                    $ds(this).css(
                        "background", "-webkit-radial-gradient(center, ellipse cover, " + colorIn + " 0%," + colorOut + " 100%)"
                    );
                }
                
            // Check if the browser used is internet explorer    
            } 

            else if ( isIE ) {
                // Check if the gradient section has the class gradient-horizontal
                if ( $ds(this).hasClass("gradient-horizontal") ) {
                    gradientHorizontal.css({
                        "background" : "-ms-linear-gradient(left, " + colorIn + " 0%, " + colorOut + " 100%)",
                        "filter" : "progid:DXImageTransform.Microsoft.gradient(startColorstr=\"" + colorIn + "\", endColorstr=\"" + colorOut + "\", GradientType=1);"
                    });
                }
                
                // Check if the gradient section has the class gradient-vertical    
                if ( $ds(this).hasClass("gradient-vertical") ) {
                    gradientVertical.css({
                        "background" : "-ms-linear-gradient(top, " + colorIn + " 0%, " + colorOut + " 100%);",
                        "filter" : "progid:DXImageTransform.Microsoft.gradient(startColorstr=\"" + colorIn + "\", endColorstr=\"" + colorOut + "\", GradientType=0);"
                    });
                }
                
                // Check if the gradient section has the class gradient-diagonal    
                if ( $ds(this).hasClass("gradient-diagonal") ) {
                    gradientDiagonal.css({
                        "background" : "-ms-linear-gradient(45deg, " + colorIn + " 0%, " + colorOut + " 100%);",
                        "filter" : "progid:DXImageTransform.Microsoft.gradient(startColorstr=\"" + colorIn + "\", endColorstr=\"" + colorOut + "\", GradientType=1);"
                    });
                }

                // Check if the gradient section has the class gradient-diagonal-inverse
                if ( $ds(this).hasClass("gradient-diagonal-inverse") ) {
                    gradientDiagonalInverse.css({
                        "background" : "-ms-linear-gradient(-45deg, " + colorIn + " 0%, " + colorOut + " 100%);",
                        "filter" : "progid:DXImageTransform.Microsoft.gradient(startColorstr=\"" + colorIn + "\", endColorstr=\"" + colorOut + "\", GradientType=1);"
                    });
                }
                // Check if the gradient section has the class gradient-radial     
                if ( $ds(this).hasClass("gradient-radial") ) {
                    gradientRadial.css({
                        "background" : "-ms-radial-gradient(center, ellipse cover, " + colorIn + " 0%, " + colorOut + " 100%)",
                        "filter" : "progid:DXImageTransform.Microsoft.gradient(startColorstr=\"" + colorIn + "\", endColorstr=\"" + colorOut + "\", GradientType=1);"
                    });
                }
            } 
            else {
                gradient.css("background", colorIn);
            }
        });

    }



    /* 
    \ ----------------------------------------------------------------------------
     | Initialize portfolio carousels
    / ----------------------------------------------------------------------------
    */
    $.fn.initPortfolioSlider = function() {
        $ds(".portfolio-slides").each(function(){
           $ds(this).carouFredSel({
               circular    : true,
               responsive  : true,
               prev        : {
                   button      : function() {
                       return $ds(this).closest(".portfolio-slider-holder").find(".btn-portfolio-angle-left");
                   }   
               },
               next        : {
                   button      : function() {
                       return $ds(this).closest(".portfolio-slider-holder").find(".btn-portfolio-angle-right");
                   }   
               },
               items       : {
                   width : 300,
                   height: "auto",
                   visible : {
                       min     : 1,
                       max     : 5
                   }
               },
               scroll      : {
                   items: 1,
                   duration    : 600,
                   easing      : "swing"
               },
               swipe       : {
                   onTouch     : true,
                   onMouse     : true,
                   onBefore    : function(){
                       $ds(this).find("a").addClass("disable");
                       $ds(this).find("li").trigger("mouseleave");
                   },
                   onAfter     : function(){
                       $ds(this).find("a").removeClass("disable");
                   }
               }
           });
        });
        $ds(".portfolio-slider-boxed .portfolio-slides").each(function(){
                $ds(this).carouFredSel({
                    circular    : true,
                    responsive  : true,
                    prev        : {
                        button      : function() {
                            return $ds(this).closest(".portfolio-slider-holder").find(".btn-portfolio-angle-left");
                        }   
                    },
                    next        : {
                        button      : function() {
                            return $ds(this).closest(".portfolio-slider-holder").find(".btn-portfolio-angle-right");
                        }   
                    },
                    items       : {
                        width : 300,
                        height: "auto",
                        visible : {
                            min     : 1,
                            max     : 5
                        }
                    },
                    scroll      : {
                        items: 1,
                        duration    : 600,
                        easing      : "swing"
                    },
                    swipe       : {
                        onTouch     : true,
                        onMouse     : true,
                        onBefore    : function(){
                            $ds(this).find("a").addClass("disable");
                            $ds(this).find("li").trigger("mouseleave");
                        },
                        onAfter     : function(){
                            $ds(this).find("a").removeClass("disable");
                        }
                    }
                })
            });
    };
    
    $.fn.initTeamSlider = function () {
      $ds(".team-slides").each(function(){
          $ds(this).carouFredSel({
              circular    : true,
              responsive  : true,
              prev        : {
                  button      : function() {
                      return $ds(this).closest(".team-slider-holder").find(".btn-team-angle-left");
                  }   
              },
              next        : {
                  button      : function() {
                      return $ds(this).closest(".team-slider-holder").find(".btn-team-angle-right");
                  }   
              },
              items       : {
                  width : 300,
                  height: "auto",
                  visible : {
                      min     : 1,
                      max     : 5
                  }
              },
              scroll      : {
                  items: 1,
                  duration    : 600,
                  easing      : "swing"
              },
              swipe       : {
                  onTouch     : true,
                  onMouse     : true,
                  onBefore    : function(){
                      $ds(this).find("a").addClass("disable");
                      $ds(this).find("li").trigger("mouseleave");
                  },
                  onAfter     : function(){
                      $ds(this).find("a").removeClass("disable");
                  }
              }
          })
      });
    }

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize blog carousels
    / ----------------------------------------------------------------------------
    */
    $.fn.initBlogSlider = function() {
      $ds(".post-slides").each(function(){
        $ds(this).carouFredSel({
            circular    : true,
            responsive  : true,
            prev        : {
                button      : function() {
                    return $ds(this).closest(".post-slider-holder").find(".btn-post-angle-left");
                }   
            },
            next        : {
                button      : function() {
                    return $ds(this).closest(".post-slider-holder").find(".btn-post-angle-right");
                }   
            },
            items       : {
                width : 300,
                height: "auto",
                visible : {
                    min     : 1,
                    max     : 6
                }
            },
            scroll      : {
                items: 1,
                duration    : 600,
                easing      : "quadratic"
            },
            swipe       : {
                onTouch     : true,
                onMouse     : true,
                onBefore    : function(){
                    $ds(this).find("a").addClass("disable");
                    $ds(this).find("li").trigger("mouseleave");
                },
                onAfter     : function(){
                    $ds(this).find("a").removeClass("disable");
                }
            }
          })
      });
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize blog carousels
    / ----------------------------------------------------------------------------
    */
    $.fn.initProductsSlider = function() {
      $ds(".products-slides").each(function(){
        $ds(this).carouFredSel({
            circular    : true,
            responsive  : true,
            prev        : {
                button      : function() {
                    return $ds(this).closest(".products-slider-holder").find(".btn-product-angle-left");
                }   
            },
            next        : {
                button      : function() {
                    return $ds(this).closest(".products-slider-holder").find(".btn-product-angle-right");
                }   
            },
            items       : {
                width : 240,
                height: "auto",
                visible : {
                    min     : 1,
                    max     : 4
                }
            },
            scroll      : {
                items: 1,
                duration    : 600,
                easing      : "quadratic"
            },
            swipe       : {
                onTouch     : true,
                onMouse     : true,
                onBefore    : function(){
                    $ds(this).find("a").addClass("disable");
                    $ds(this).find("li").trigger("mouseleave");
                },
                onAfter     : function(){
                    $ds(this).find("a").removeClass("disable");
                }
            }
          })
      });
    };
    

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Device Sliders
    / ----------------------------------------------------------------------------
    */
    $.fn.initDeviceSlider = function() {
        $ds(".device-slider").each(function(){
            $ds("flexslider").flexslider({
                animation: "fade",
                directionNav: true,
                prevText:"<div><span class=\"fa fa-angle-left\"></span></div>",
                nextText:"<div><span class=\"fa fa-angle-right\"></span></div>",
                controlNav: false,
                start: function(slider){
                  $ds("body").removeClass("loading");
                }
            });
        });
    };
    


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Clients Slider
    / ----------------------------------------------------------------------------
    */
    $.fn.initClientSlider = function() {
      $ds(".clients-slides").each(function(){
        $ds(this).carouFredSel({
            circular    : true,
            responsive  : true,
            prev        : {
                button      : function() {
                    return $ds(this).closest(".clients-slider-holder").find(".btn-client-angle-left");
                }   
            },
            next        : {
                button      : function() {
                    return $ds(this).closest(".clients-slider-holder").find(".btn-client-angle-right");
                }   
            },
            items       : {
                width : 200,
                visible : {
                    min     : 1,
                    max     : 7
                }
            },
            scroll      : {
                items: 1,
                duration    : 600,
                easing      : "quadratic"
            },
            swipe       : {
                onTouch     : true,
                onMouse     : true,
                onBefore    : function(){
                    $ds(this).find("a").addClass("disable");
                    $ds(this).find("li").trigger("mouseleave");
                },
                onAfter     : function(){
                    $ds(this).find("a").removeClass("disable");
                }
            }
        })
      });
    };


     

    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Progress Icons
    / ----------------------------------------------------------------------------
    */
    $.fn.initProgressIcons = function() {
        $ds(".progress-bars-icons").waypoint({
            offset      : "100%",
            triggerOnce : true,
            handler     : function() {
                var el      = $ds(this);
                var enable  = el.data("enabled-number") || 1;
                var color   = el.data("color") || null;
                var icon    = el.find(".progress-icon");
                var timeout = 300;
                icon.each(function(i){
                    if ( i < enable ) {
                        var time = ( i + 1 ) * timeout;
                        setTimeout(function(){
                            $ds(icon[i]).addClass("enabled").css("color",color);
                        }, time);
                    }
                });
            }
        });
    };


    $.fn.initVerticalProgressBars = function() {
      if($ds(".progress-vertical").length){
        $(".progress-bar").each(function() {
          $(this).waypoint(function(){ 
              var percentage = $(this).data("percentage");
              $(this).animate({ "height" : percentage + "%"}, percentage*20);
          },{ offset: "80%" }); 
        });
      }
    };

    $.fn.initHorizontalProgressBars = function() {
      $(".progress-horizontal").waypoint({
        offset    : "100%",
        triggerOnce : true,
        handler   : function(){
          $(this).addClass("show");
        }
      });
    };


    /* 
    \ ----------------------------------------------------------------------------
     | Initialize Counter Box
    / ----------------------------------------------------------------------------
    */
    $.fn.initCounter = function() {

        $ds(".counter-box .counter-number").waypoint({

                offset      : "100%",
                triggerOnce : true,

                handler     : function(){

                    var el          = $ds(this);
                    var duration    = 2300;//Math.floor((Math.random()*1000)+1000);
                    var to          = el.data("to");

                    $ds({property:0}).animate({property:to}, {
                        duration    : duration,
                        easing      :"linear",
                        step        : function() {
                            el.text(Math.floor(this.property));
                        },
                        complete    : function() {
                            el.text(this.property);
                        }
                    });
                }
            });
    };



    /* 
    \ ----------------------------------------------------------------------------
     | Shopping Cart Dropdown
    / ----------------------------------------------------------------------------
    */
    $.fn.shoppingCartDropdown = function() {
      $(".shopping-cart-holder").on("mouseover",function(){
        $(this).siblings(".shopping-cart-dropdown").addClass("show");
      });
      $(".shopping-cart-holder").on("mouseleave",function(){
        setTimeout(function () {
          $(this).siblings(".shopping-cart-dropdown").addClass("hide");          
        },1000);
      });
    };

    
    $.fn.initMobileShowcase = function () {
        $(".unity-ms-wrapper").each(function(i,el) {
          el = $ds(el);
          if ( el.visible (true) ) { 
            setTimeout(function() {
              el.addClass("unity-ms-view-layers");              
            }, 1000);
          }
        });
    };
    $.fn.blogIsotope = function(){
       if(jQuery().isotope) {
        $('.posts-section').masonry({
          columnWidth: '.sani-1-4,.sani-1-2,.sani-1-3',
          itemSelector: '.post-grid',
          percentPosition: true
        });
      }
    };

    $.fn.productsIsotope = function(){
       if(jQuery().isotope) {
        $('.product-section').masonry({
          columnWidth: '.sani-1-4,.sani-1-2,.sani-1-3',
          itemSelector: '.product-col',
          percentPosition: true
        });
      }
    };

     /* 
    \ ----------------------------------------------------------------------------
     | Initialize masonry view for portfolio
    / ----------------------------------------------------------------------------
    */
    $.fn.initMasonryGallery = function() {
      if(jQuery().isotope) {
        $(".gallery-section").imagesLoaded(function(){
          $(".gallery-isotope").isotope({
            layoutMode: "masonry",
            itemSelector: ".gallery-col"
          });
        });
      }
    };
 
    /* 
    \ ----------------------------------------------------------------------------
     | Set animation for a given section
    / ----------------------------------------------------------------------------
    */
    $.fn.sani_animation = function(){

        $ds(".animated").each(function(i, el){
          var el = $ds(el),
          animationType = $ds(this).data("animate-type"),
          animationDelay = 50 * i;
          if (el.visible(true)) {
            setTimeout(function() {
              el.addClass(animationType);
              el.css("visibility","visible");
            }, animationDelay);
          } 
        });

    };
    
    $ds(document).ready(function() { 
        // Preloader
         $ds("body").imagesLoaded(function(){
          $ds(".preloader").fadeOut(500);
        });
        // Scrolling
        $jk.initMobileMenu();
        $wd.scroll(function(){
          $jk.stickyMenu(); 
          $jk.sani_animation();
          
          $jk.initMobileShowcase();
          if ($(this).scrollTop() > 100) {
            $(".scroll-top").fadeIn();
          } else {
            $(".scroll-top").fadeOut();
          }
        });
        $jk.initPageScroll();
        
        $jk.adaptMenu();
        $jk.toggleSF();
        $jk.subMenuPosition();
        $jk.stickyMenu();
        $jk.addToCart();
        $jk.scrollTop();
        $jk.initFitvids();
        // Nicescroll
        $jk.initNiceScroll();
        $jk.initIsotopePortfolio();
        $(window).on("load", function (e) {
          $jk.blogIsotope();
          $jk.productsIsotope();
          $jk.initMasonryGallery();
          $jk.initClientSlider();
        });
        $jk.initPrettyphoto();
        $jk.initMaps();
        $jk.initMediaElement();
        
        $jk.setFlipboxHeight();
        $jk.InitAccordion();
        $jk.initFlexSlider();
        $jk.InitTabs();
        $jk.initEasyPieChart();
        $jk.insertGradientColor();
        $jk.initBlogSlider();
        $ds(".portfolio-slides").imagesLoaded(function(){
          $jk.initPortfolioSlider();
        });
        $jk.initTeamSlider();
        $jk.initProductsSlider();
        $jk.initDeviceSlider();
        
        $jk.initProgressIcons();
        $jk.initHorizontalProgressBars();
        $jk.initVerticalProgressBars();
        $jk.initCounter();
        $jk.fixedFooter();
        $wd.on("resize",function(){
          $jk.toggleSF();
          $jk.adaptMenu();
          $jk.subMenuPosition();
          $jk.setFlipboxHeight();
        });

        $ds(".scroll-top").click(function(){
          $("html, body").animate({scrollTop : 0},800);
          return false;
        });


        /* 
        \ ----------------------------------------------------------------------------
         | Initialize Tooltips
        / ----------------------------------------------------------------------------
        */
        $ds("[data-toggle=\"tooltip\"]").tooltip();
        var $height_h = 0;
        var $height_t = 0;
        if ( $(".titlebar-full-section").hasClass("full") ) {
          if ( $(".header-main-wrapper").hasClass("header-default") || 
               $(".header-main-wrapper").hasClass("header-stack-left") || 
               $(".header-main-wrapper").hasClass("header-stack-center") || 
               $(".header-main-wrapper").hasClass("header-below") ) {
            
            $height_h = $(".header-main-wrapper").height();
          }
          if ( $("#wpadminbar").length) {
            $height_t = 32;
          }

          $(".titlebar-full-section").css("height",$wd.height() - $height_h - $height_t);
        }
        
        /* 
        \ ----------------------------------------------------------------------------
         | Initialize Popovers
        / ----------------------------------------------------------------------------
        */
        $ds("[data-toggle=\"popover\"]").popover();

        /**
         * search show/hide states.
         */
        $ds(".search-toggle").on("click",function(err){

            err.preventDefault();

            if($ds(".search-wrapper").hasClass("open")){
                $ds(".search-wrapper").removeClass("open");
                $ds("#search_close i").removeClass("fa-close").addClass("fa-search");
                $ds("#search_close").removeAttr("id").attr("id","search_button");
            }
            else {
                $ds(".search-wrapper").addClass("open");
                $ds("#search_button i").removeClass("fa-search").addClass("fa-close");
                $ds("#search_button").removeAttr("id").attr("id","search_close");
            }
        });

    });
})(jQuery);